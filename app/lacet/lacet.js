!function(){var a=!1,b=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/;this.Class=function(){},Class.extend=function(c){function d(){!a&&this.init&&this.init.apply(this,arguments)}var e=this.prototype;a=!0;var f=new this;a=!1;for(var g in c)f[g]="function"==typeof c[g]&&"function"==typeof e[g]&&b.test(c[g])?function(a,b){return function(){var c=this._super;this._super=e[a];var d=b.apply(this,arguments);return this._super=c,d}}(g,c[g]):c[g];return d.prototype=f,d.prototype.constructor=d,d.extend=arguments.callee,d}}(),function(a){a.fn.alterClass=function(b,c){var d=this;if(b.indexOf("*")===-1)return d.removeClass(b),c?d.addClass(c):d;var e=new RegExp("\\s"+b.replace(/\*/g,"[A-Za-z0-9-_]+").split(" ").join("\\s|\\s")+"\\s","g");return d.each(function(b,c){for(var d=" "+c.className+" ";e.test(d);)d=d.replace(e," ");c.className=a.trim(d)}),c?d.addClass(c):d}}(jQuery),jQuery.expr[":"].hasClassStartingWith=function(a,b,c){var d=new RegExp("\\b"+c[3]);return d.test(a.className)},$.fn.serializeObject=function(){var a={},b=this.serializeArray();return $.each(b,function(){void 0!==a[this.name]?(a[this.name].push||(a[this.name]=[a[this.name]]),a[this.name].push(this.value||"")):a[this.name]=this.value||""}),a},String.prototype.upperFirstLetter=function(){return this.charAt(0).toUpperCase()+this.slice(1)},String.prototype.lowerFirstLetter=function(){return this.charAt(0).toLowerCase()+this.slice(1)},Array.prototype.move=function(a,b){if(b>=this.length)for(var c=b-this.length;c--+1;)this.push(void 0);return this.splice(b,0,this.splice(a,1)[0]),this};var RestCollection=Class.extend({init:function(a){this.url=a,$.ajaxSetup({xhrFields:{withCredentials:!0}})},call:function(a,b,c,d){return this.ajaxRequest(this.url+"/"+a,JSON.stringify(b),c,d)},ajaxRequest:function(a,b,c,d){return jQuery.ajax({headers:{Accept:"application/json","Content-Type":"application/json"},type:c,url:a,data:b,dataType:"json",success:d})},getById:function(a,b){return console.log(this.url),this.ajaxRequest(this.url+"/"+a,{},"get",b)},save:function(a,b){return console.log(this.url),this.ajaxRequest(this.url,JSON.stringify(a),"post",b)},insert:function(a,b){return a.id=null,this.ajaxRequest(this.url,JSON.stringify(a),"post",b)},update:function(a,b,c,d){var e=this;this.find(a,c,function(a){$.each(a.rows,function(a,c){e.ajaxRequest(e.url,JSON.stringify($.extend(c,b)),"post",d)})})},findOne:function(a,b,c){var d=this.url;return"object"!=typeof a&&(d=d+"/"+a),"function"!=typeof b||c||(c=b),this.ajaxRequest(d,a,"get",function(a){c(a.rows&&a.rows.length>0?a.rows[0]:a?a:null)})},find:function(a,b,c){return"function"!=typeof a||b||c?"object"!=typeof a&&(a={id:a}):(c=a,a={}),"function"!=typeof b||c||(c=b),this.ajaxRequest(this.url,a,"get",c)},remove:function(a,b){var c=this.url+"/"+a;return this.ajaxRequest(c,{},"delete",b)}}),PagedCollection=RestCollection.extend({init:function(a){this._super(a),this.page=1,this.rows=20,this.sord="ASC",this.sidx="id",this.criteria={},this.totalpages=0,this.totalrecords=0,this.or=!1},setRows:function(a){return this.rows=a,this},setPage:function(a){var b=Number(this.totalpages),c=Number(a);return c>b&&(c=b),c<1&&(c=1),this.page=Number(c),this},nextPage:function(){return this.setPage(Number(this.page)+1)},previousPage:function(){return this.setPage(Number(this.page)-1)},find:function(a){var b=this,c={page:this.page,rows:this.rows,sord:this.sord,sidx:this.sidx,or:this.or,filterByFields:JSON.stringify(this.criteria)};return this._super(c,function(c){b.totalpages=c.totalpages,b.totalrecords=c.totalrecords,a&&a(c)})},toggleSort:function(){return"ASC"===this.sord?this.sord="DESC":this.sord="ASC",this},ascending:function(){return this.sord="ASC",this},descending:function(){return this.sord="DESC",this},orMode:function(){return this.or=!0,this},qry:function(){return this.criteria={},this.or=!1,this},add:function(a,b,c){var d={},e={};return d["$"+b]=c,e[a]=d,this.criteria=$.extend(this.criteria,e),this},cn:function(a,b){return this.add(a,"cn",b)},icn:function(a,b){return this.add(a,"icn",b)},bw:function(a,b){return this.add(a,"bw",b)},ew:function(a,b){return this.add(a,"ew",b)},eq:function(a,b){return this.add(a,"eq",b)},ne:function(a,b){return this.add(a,"ne",b)},nc:function(a,b){return this.add(a,"nc",b)},en:function(a,b){return this.add(a,"en",b)},bn:function(a,b){return this.add(a,"bn",b)},gt:function(a,b){return this.add(a,"gt",b)},ge:function(a,b){return this.add(a,"ge",b)},lt:function(a,b){return this.add(a,"lt",b)},le:function(a,b){return this.add(a,"le",b)},in:function(a,b){return this.add(a,"in",b)},nn:function(a,b){return this.add(a,"nn",b)}});!function(){function a(){this.sessionvars={account:{login:null,firstname:null,lastName:null,email:null,roles:[]},userRoles:{all:"*",admin:"ROLE_ADMIN",superUser:"ROLE_SUPER_USER",user:"ROLE_USER"}}}return a.prototype.init=function(a){this.sessionvars=$.extend(this.sessionvars,a),console.log(this.sessionvars)},a.prototype.isAuthenticated=function(){return this.getAccount().login},a.prototype.getAccount=function(){return this.sessionvars.account},a.prototype.isAdmin=function(){return this.isAuthorized("ROLE_ADMIN")},a.prototype.isSuperUser=function(){return this.isAuthorized("ROLE_SUPER_USER")},a.prototype.isAuthorized=function(a){return this.isAuthenticated()&&this.sessionvars.account.roles.indexOf(a)!==-1},window.session=new a,jQuery(function(){}),window.session}(jQuery),function(){var a=PagedCollection.extend({init:function(){base_url||(base_url="../"),this._super(base_url+"mongo/"+app_name+"/pages")}});window.pages=new a}(jQuery),function(){var a=PagedCollection.extend({init:function(){base_url||(base_url="../"),this._super(base_url+"mongo/"+app_name+"/custom_snippets")}});window.custom_snippets=new a}(jQuery),function(){var a=PagedCollection.extend({init:function(){base_url||(base_url="../"),this._super(base_url+"/mongo/connections")}});window.connections=new a}(jQuery);var SnippetInspector=Class.extend({init:function(){JSONEditor.defaults.options.theme="bootstrap3Custom",JSONEditor.defaults.theme="bootstrap3Custom",JSONEditor.defaults.iconlib="fontawesome4",JSONEditor.defaults.resolvers.unshift(function(a){return"string"===a.type&&"icon"===a.format?"iconChooser":"hidden"===a.format?"hidden":"string"===a.type&&"link"===a.format?"linkChooser":"string"===a.type&&"columns"===a.format?"columnChooser":"string"===a.type&&"fieldChooser"===a.format?"fieldChooser":"string"===a.type&&"endpointChooser"===a.format?"endpointChooser":"string"===a.type&&"formChooser"===a.format?"formChooser":void 0})}});JSONEditor.defaults.editors.iconChooser=JSONEditor.defaults.editors.string.extend({afterInputReady:function(){this._super();var a=this,b=jQuery('<span class="input-group-btn"></span>'),c=jQuery('<button class="btn btn-default btn-sm" data-iconset="fontawesome" role="iconpicker"></button>');b.append(c),jQuery(this.input).parent().css("padding-left","15px").css("padding-right","15px").addClass("input-group").prepend(b),jQuery(c).iconpicker({placement:"top",icon:a.input.value}).on("change",function(b){a.input.value=b.icon,a.value=a.input.value,a.is_dirty=!0,a.onChange(!0)})}}),JSONEditor.defaults.editors.formChooser=JSONEditor.defaults.editors.string.extend({buildList:function(a){var b=this;jQuery.each(window.lacetInspector.buildFormDropList(),function(c,d){var e=jQuery(d);e.unbind("click").bind("click",function(a){a.preventDefault(),b.input.value=$(this).find("a").html(),b.value=b.input.value,b.is_dirty=!0,b.onChange(!0)}),a.append(e)})},afterInputReady:function(){this._super();var a=this,b=jQuery('<div class="input-group-btn"></div>'),c=jQuery('<button class="btn btn-default btn-sm dropdown-toggle" data-toggle="dropdown"></button>');c.append('<span class="caret"></span>');var d=jQuery('<ul class="dropdown-menu scrollable-menu"></ul>');a.buildList(d),b.append(c),b.append(d),jQuery(this.input).css("min-width","175px").parent().css("padding-left","15px").css("padding-right","15px").addClass("input-group").prepend(b)}}),JSONEditor.defaults.editors.endpointChooser=JSONEditor.defaults.editors.string.extend({buildList:function(a){var b=this;a.find(".endpoint-menu-item").unbind("click").bind("click",function(a){a.preventDefault(),b.input.value=$(this).attr("id"),b.value=b.input.value,b.is_dirty=!0,b.onChange(!0)})},afterInputReady:function(){this._super();var a=this,b=jQuery('<div class="input-group-btn"></div>'),c=jQuery('<button class="btn btn-default btn-sm dropdown-toggle" data-toggle="dropdown"></button>');c.append('<span class="caret"></span>'),b.append(c),console.log("Create Endpoint Drop List"),window.serverConfig.buildDropList().done(function(c){a.buildList(c),b.append(c)}),jQuery(this.input).css("min-width","175px").parent().css("padding-left","15px").css("padding-right","15px").addClass("input-group").prepend(b)}}),JSONEditor.defaults.editors.fieldChooser=JSONEditor.defaults.editors.string.extend({buildList:function(a){var b=this,c=[];jQuery("#main-content").find("[name]").each(function(){try{c.push("<li><a>"+jQuery(this).attr("name")+"</a></li>")}catch(a){console.log(a)}}),c.sort(),jQuery.each(c,function(c,d){var e=jQuery(d);e.unbind("click").bind("click",function(a){a.preventDefault(),b.input.value=$(this).find("a").html(),b.value=b.input.value,b.is_dirty=!0,b.onChange(!0)}),a.append(e)})},afterInputReady:function(){this._super();var a=this,b=jQuery('<div class="input-group-btn"></div>'),c=jQuery('<button class="btn btn-default btn-sm dropdown-toggle" data-toggle="dropdown"></button>');c.append('<span class="caret"></span>');var d=jQuery('<ul class="dropdown-menu scrollable-menu"></ul>');a.buildList(d),b.append(c),b.append(d),jQuery(this.input).css("min-width","220px").parent().css("padding-left","15px").css("padding-right","15px").addClass("input-group").prepend(b)}}),JSONEditor.defaults.editors.columnChooser=JSONEditor.defaults.editors.string.extend({buildList:function(a,b){var c=this;if(a&&"none"!==a){console.log("Found Endpoint "+a);var d=new RestCollection(window.serverConfig.getEndpoint(a));d.call("columns",{},"get",function(a){var d=[],e=[];jQuery.each(a.columns,function(a,b){b.includes(".")?e.push("<li><a>"+b+"</a></li>"):d.push("<li><a>"+b+"</a></li>")}),d.sort(),d.push('<li class="divider"></li>'),e.sort(),d=d.concat(e),jQuery.each(d,function(a,d){var e=jQuery(d);e.unbind("click").bind("click",function(a){a.preventDefault(),c.input.value=$(this).find("a").html(),c.value=c.input.value,c.is_dirty=!0,c.onChange(!0)}),b.append(e)})})}},afterInputReady:function(){this._super();var a=this,b=a.watched_values.endpoint,c=jQuery('<div class="input-group-btn"></div>'),d=jQuery('<button class="btn btn-default btn-sm dropdown-toggle" data-toggle="dropdown"></button>');d.append('<span class="caret"></span>');var e=jQuery('<ul class="dropdown-menu scrollable-menu"></ul>');a.buildList(b,e),a.link_watchers.push(function(b){e.html(""),a.buildList(b.endpoint,e)}),c.append(d),c.append(e),jQuery(this.input).css("min-width","220px").parent().css("padding-left","15px").css("padding-right","15px").addClass("input-group").prepend(c)}}),JSONEditor.defaults.editors.linkChooser=JSONEditor.defaults.editors.string.extend({buildList:function(a){var b=this;window.pages.qry().find(function(c){var d=[];jQuery.each(c.rows,function(a,b){d.push('<li><a href="#" id="#/lacet/'+b.name+'"> '+b.name+"</a></li>")}),d.sort(),jQuery.each(d,function(c,d){var e=jQuery(d);e.unbind("click").bind("click",function(a){a.preventDefault(),b.input.value=$(this).find("a").attr("id"),b.value=b.input.value,b.is_dirty=!0,b.onChange(!0)}),a.append(e)})})},afterInputReady:function(){this._super();var a=jQuery('<div class="input-group-btn"></div>'),b=jQuery('<button class="btn btn-default btn-sm dropdown-toggle" data-toggle="dropdown"></button>');b.append('<span class="caret"></span>');var c=jQuery('<ul class="dropdown-menu"></ul>');this.buildList(c),a.append(b),a.append(c),jQuery(this.input).parent().css("padding-left","15px").css("padding-right","15px").addClass("input-group").prepend(a)}}),JSONEditor.defaults.editors.hidden=JSONEditor.defaults.editors.string.extend({afterInputReady:function(){this._super(),jQuery(this.label).parent().removeClass("form-group"),jQuery(this.label).html(""),jQuery(this.input).attr("type","hidden")}}),JSONEditor.defaults.themes.bootstrap3Custom=JSONEditor.AbstractTheme.extend({getSelectInput:function(a){var b=this._super(a);return b.className+="form-control",b},setGridColumnSize:function(a,b){a.className="col-md-"+b},afterInputReady:function(a){a.controlgroup||(a.controlgroup=this.closest(a,".form-group"),this.closest(a,".compact")&&a.controlgroup&&(a.controlgroup.style.marginBottom=20))},getTextareaInput:function(){var a=document.createElement("textarea");return a.className="form-control",a},getRangeInput:function(a,b,c){return this._super(a,b,c)},getFormInputField:function(a){var b=this._super(a);return"checkbox"!==a&&(b.className+="form-control"),b},getFormControl:function(a,b,c){var d=document.createElement("div");if(a&&"checkbox"===b.type)d.className+=" checkbox",a.appendChild(b),a.style.fontSize="14px",d.style.marginTop="0",d.appendChild(a),b.style.position="relative",b.style.cssFloat="left";else{d.className+=" form-group-sm ",a&&(a.className+=" control-label",a.className+=" col-sm-3",d.appendChild(a));var e=document.createElement("div");e.className+=" col-sm-9",e.appendChild(b),d.appendChild(e)}return c&&d.appendChild(c),d},getIndentedPanel:function(){var a=document.createElement("form");return a.className="form-horizontal",a.style.paddingBottom=0,a},getFormInputDescription:function(a){var b=document.createElement("p");return b.className="help-block",b.innerHTML=a,b},getHeaderButtonHolder:function(){var a=this.getButtonHolder();return a.style.marginLeft="10px",a},getButtonHolder:function(){var a=document.createElement("div");return a.className="btn-group",a},getButton:function(a,b,c){var d=this._super(a,b,c);return d.className+="btn btn-default btn-sm",d},getTable:function(){var a=document.createElement("table");return a.className="table table-bordered",a.style.width="auto",a.style.maxWidth="none",a},addInputError:function(a,b){a.controlgroup&&(a.controlgroup.className+=" has-error",a.errmsg?a.errmsg.style.display="":(a.errmsg=document.createElement("p"),a.errmsg.className="help-block errormsg",a.controlgroup.appendChild(a.errmsg)),a.errmsg.textContent=b)},removeInputError:function(a){a.errmsg&&(a.errmsg.style.display="none",a.controlgroup.className=a.controlgroup.className.replace(/\s?has-error/g,""))},getTabHolder:function(){var a=document.createElement("div");return a.innerHTML="<div class='tabs list-group col-md-2'></div><div class='col-md-10'></div>",a.className="rows",a},getTab:function(a){var b=document.createElement("a");return b.className="list-group-item",b.setAttribute("href","#"),b.appendChild(a),b},markTabActive:function(a){a.className+=" active"},markTabInactive:function(a){a.className=a.className.replace(/\s?active/g,"")},getProgressBar:function(){var a=0,b=100,c=0,d=document.createElement("div");d.className="progress";var e=document.createElement("div");return e.className="progress-bar",e.setAttribute("role","progressbar"),e.setAttribute("aria-valuenow",c),e.setAttribute("aria-valuemin",a),e.setAttribute("aria-valuenax",b),e.innerHTML=c+"%",d.appendChild(e),d},updateProgressBar:function(a,b){if(a){var c=a.firstChild,d=b+"%";c.setAttribute("aria-valuenow",b),c.style.width=d,c.innerHTML=d}},updateProgressBarUnknown:function(a){if(a){var b=a.firstChild;a.className="progress progress-striped active",b.removeAttribute("aria-valuenow"),b.style.width="100%",b.innerHTML=""}}});var SnippetTypes=Class.extend({snippet_templates:{},schemas:{},init:function(){this.snippetInspector=new SnippetInspector,this.add(BootstrapSnippet).add(BootstrapField).add(BootstrapText).add(BootstrapHeader).add(BootstrapIcon).add(BootstrapLink).add(BootstrapButton).add(BootstrapDoubleButton).add(BootstrapSelect).add(BootstrapCarousel).add(BootstrapLabelValue).add(BootstrapRadio).add(BootstrapForm).add(BootstrapImage).add(BootstrapJumbotron).add(BootstrapCheckbox).add(BootstrapButtonGroup).add(BootstrapMovie).add(BootstrapFooter).add(BootstrapPanel).add(BootstrapNavLink).add(BootstrapSideBar).add({id:"blunt.address",type:"object",title:"Address",properties:{text:{type:"string",format:"textarea",default:'<strong>Apple</strong><br/>1 Infinite Loop<br/>Cupertino, CA 95014<br/> <abbr title="Phone">P:</abbr> (408) 996-1010'}}}).add({id:"blunt.headertext",type:"object",title:"Header Text",extends:[BootstrapHeader,BootstrapText,BootstrapLink,BootstrapIcon]}).add({id:"blunt.media",type:"object",title:"Media",extends:[BootstrapHeader,BootstrapText,BootstrapImage],properties:{image:{type:"string",default:"img/avatar3.jpg"},responsive:{type:"string",default:""}}})},createValidSchema:function(a){var b={};b.id=a.kind,b.type="object",b.title=a.name;try{b.properties=JSON.parse(a.schema)}catch(a){b.properties={},console.log(a)}return b},registerSnippet:function(a){this.add(a.schema())},add:function(a){return a.id||alert('snippet must have a parameter named kind i.e {kind:"yourcompany.button"}'),this.schemas[a.id]?console.log("Snippet Type "+a.id+" already exists and will not be added"):this.schemas[a.id]=a,this},getSchema:function(a){return this.schemas[a]?this.schemas[a]:{}},getDefaults:function(a){var b={},c=this.getSchema(a);if(c){var d=new JSONEditor(document.getElementById("temp"),{schema:c});b=d.getValue(),d.destroy()}return b}});Handlebars.registerPartial("id",'{{#if id}} id="{{ id }}" {{/if}}'),Handlebars.registerPartial("classes","{{#if classes}} {{classes}} {{/if}}"),Handlebars.registerPartial("name",'{{#if name}} name="{{ name }}" {{/if}}'),Handlebars.registerPartial("idNameField","{{>id}} {{>name}}"),Handlebars.registerPartial("readonly",'{{#if readonly}}  readonly="readonly"  {{/if}}'),Handlebars.registerPartial("required",'{{#if required}}  required="required"  {{/if}}'),Handlebars.registerPartial("checked",'{{#if checked}}  checked="checked"  {{/if}}'),Handlebars.registerPartial("placeholder",'{{#if placeholder}} placeholder="{{ placeholder }}"  {{/if}}'),Handlebars.registerPartial("multiple",'{{#if multiple}} multiple="multiple"  {{/if}}'),Handlebars.registerPartial("selected",'{{#if selected}} selected="selected"  {{/if}}'),Handlebars.registerPartial("inputsize","{{#if inputsize}} {{inputsize}}  {{/if}}"),Handlebars.registerPartial("helptext",'{{#if helptext}} <p class="help-block">{{ helptext }}</p>  {{/if}}'),Handlebars.registerPartial("textfield",'<input class="form-control {{classes}} {{ inputsize }}"  type="text" {{>idNameField}} {{>placeholder}} {{>required}} {{>readonly}}/>'),Handlebars.registerPartial("legend","{{#if legend}} <legend>{{ legend }}</legend> {{/if}}"),Handlebars.registerPartial("linkText",'{{#if linkText}} <div><a class="btn editable-linkText" href="#">{{{linkText}}}</a></div>{{/if}}'),Handlebars.registerHelper("times",function(a,b){for(var c="",d=1;d<a;++d)c+=b.fn(d);return c});var handleBarsTemplate={},BootstrapSnippet={id:"bootstrap.snippet",type:"object",properties:{id:{type:"string",default:null},edit_mode:{type:"boolean",format:"hidden",default:!1},classes:{type:"string",default:null}}},BootstrapField={title:"Field",id:"bootstrap.field",type:"object",extends:BootstrapSnippet,properties:{field_endpoint:{title:"Rest URL",type:"string",format:"hidden",default:"none"},label:{type:"string",default:"Field",watch:{name:"name"}},name:{type:"string",format:"columns",default:"id",watch:{endpoint:"field_endpoint"}},submit:{title:"submit",type:"boolean",enum:[!1,!0],options:{enum_titles:["No","Yes"]},default:!0},required:{type:"string",enum:["","required"],options:{enum_titles:["No","Yes"]},default:""},readonly:{type:"string",enum:["","readonly"],options:{enum_titles:["No","Yes"]},default:""},inputsize:{type:"string",enum:["input-sm","","input-lg"],options:{enum_titles:["Small","Medium","Large"]},default:""},placeholder:{type:"string",default:null},helptext:{type:"string",default:null}}},BootstrapLabelValue={id:"bootstrap.labelValue",type:"object",properties:{label:{type:"string",default:"Label"},value:{type:"string",default:"Value"}}},BootstrapForm={id:"bootstrap.form",type:"object",title:"Form",properties:{legend:{type:"string",default:"My Awesome Form"},type:{type:"string",enum:["","form-inline","form-horizontal"],options:{enum_titles:["None","Inline","Horizontal"]},default:""}}},BootstrapCheckbox={id:"bootstrap.checkbox",type:"object",title:"Checkbox",extends:BootstrapField,properties:{inline:{type:"string",enum:["checkbox","checkbox-inline"],options:{enum_titles:["No","Yes"]},default:"checkbox"},checkboxes:{type:"array",format:"table",title:" ",uniqueItems:!1,disable_collapse:!1,items:{type:"object",title:"Option",headerTemplate:"{{ i1 }}",properties:{checked:{type:"string",enum:["","checked"],options:{enum_titles:["No","Yes"]},default:""}},extends:BootstrapLabelValue},default:[{label:"Checkbox 1",value:"1"},{label:"Checkbox 2",value:"2"}]}}},BootstrapRadio={id:"bootstrap.radio",type:"object",title:"Radio",extends:BootstrapField,properties:{inline:{type:"string",enum:["radio","radio-inline"],options:{enum_titles:["No","Yes"]},default:"radio"},name:{type:"string",default:"choice"},radios:{type:"array",format:"table",title:" ",uniqueItems:!1,disable_collapse:!1,items:{type:"object",title:"Option",headerTemplate:"{{ i1 }}",properties:{},extends:BootstrapLabelValue},default:[{label:"Radio 1",value:"1"},{label:"Radio 2",value:"2"}]}}},BootstrapSelect={id:"bootstrap.select",type:"object",title:"Select",extends:BootstrapField,properties:{multiple:{type:"string",enum:["","multiple"],options:{enum_titles:["No","Yes"]},default:""},options:{type:"array",format:"table",title:" ",uniqueItems:!1,disable_collapse:!1,items:{type:"object",title:"Option",headerTemplate:"{{ i1 }}",properties:{selected:{type:"string",enum:["","selected"],options:{enum_titles:["No","Yes"]},default:""}},extends:BootstrapLabelValue},default:[{label:"Option 1",value:"1"},{label:"Option 2",value:"2"}]}}},BootstrapText={id:"bootstrap.text",type:"object",properties:{text:{format:"textarea",type:"string",default:"Lorem Ipsum is simply dummy text of the printing and typesetting industry."}}},BootstrapFooter={id:"bootstrap.footer",type:"object",properties:{footer:{type:"string",default:"What is Lorem Ipsum?"}}},BootstrapHeader={id:"bootstrap.header",type:"object",properties:{header:{type:"string",default:"<h2>What is Lorem Ipsum?</h2>"}}},BootstrapPanel={id:"bootstrap.panel",type:"object",title:"Panel",extends:[BootstrapHeader,BootstrapText,BootstrapFooter],properties:{header:{type:"string",default:"Panel Header"},text:{type:"string",default:"Panel Text"},footer:{type:"string",default:"Panel Footer"},panelColor:{type:"string",enum:["panel-default","panel-warning","panel-success","panel-primary","panel-info","panel-danger"],options:{enum_titles:["Default","Warning","Success","Primary","Info","Danger"]},default:"panel-warning"}}},BootstrapIcon={id:"bootstrap.icon",type:"object",properties:{icon:{type:"string",format:"icon",default:"fa-edit"}}},BootstrapLink={id:"bootstrap.link",type:"object",properties:{link:{type:"string",format:"link",default:"http://bluntsoftware.com"}}},BootstrapImage={id:"bootstrap.image",type:"object",properties:{image:{type:"string",default:"img/avatar1.jpg"},responsive:{type:"string",enum:["","img-responsive"],options:{enum_titles:["No","Yes"]},default:"img-responsive"},imgtype:{type:"string",enum:["","img-rounded","img-circle","img-thumbnail"],options:{enum_titles:["Normal","Rounded","Circle","Thumbnail"]},default:""}}},BootstrapMovie={id:"bootstrap.movie",type:"object",properties:{movie:{type:"string",default:"http://www.youtube.com/embed/f8jX9wTG7go"}}},BootstrapCarousel={id:"bootstrap.carousel",type:"object",title:"Carousel",extends:BootstrapSnippet,properties:{id:{default:"carousel_inSlider"},scale:{type:"boolean",default:!0},carouselList:{type:"array",title:" ",format:"tabs",uniqueItems:!1,disable_collapse:!1,items:{type:"object",title:"Panel",headerTemplate:"{{ i1 }}",extends:[BootstrapImage,BootstrapHeader,BootstrapText,BootstrapIcon]},default:[{image:"img/header_one.png",icon:"fa-edit",header:"<h2>Carousel Panel 1</h2>",text:"Carousel text for Panel 1. Double click to edit"},{image:"img/header_two.png",icon:"fa-edit",header:"<h2>Carousel Panel 2</h2>",text:"Carousel text for Panel 2. Double click to edit"}]}}},BootstrapNavLink={id:"bootstrap.navlink",title:"NavLink",extends:[BootstrapSnippet,BootstrapIcon,BootstrapLink],properties:{label:{type:"string",default:"Link"}}},BootstrapSideBar={id:"bootstrap.sidebar",title:"Sidebar",extends:[BootstrapSnippet],properties:{brand:{type:"string",default:"Side Nav"},navList:{type:"array",title:" ",format:"tabs",uniqueItems:!1,disable_collapse:!1,items:{type:"object",title:"Link",headerTemplate:"{{ i1 }}",extends:[BootstrapNavLink]},default:[{label:"Home",id:"",icon:"fa-dashboard",link:"#Home"},{label:"About",id:"",icon:"fa-dashboard",link:"#About"},{label:"Contact",id:"",icon:"fa-dashboard",link:"#Contact"},{label:"Photos",id:"",icon:"fa-dashboard",link:"#Photos"},{label:"Videos",id:"",icon:"fa-dashboard",link:"#Videos"}]}}},BootstrapButton={id:"bootstrap.button",title:"Button",extends:[BootstrapSnippet,BootstrapIcon,BootstrapLink],properties:{submit:{type:"string",format:"formChooser",default:""},label:{type:"string",default:"Single Button"},buttontype:{type:"string",enum:["btn-default","btn-warning","btn-success","btn-primary","btn-info","btn-danger"],options:{enum_titles:["Default","Warning","Success","Primary","Info","Danger"]},default:"btn-warning"},buttonsize:{type:"string",enum:["btn-xs","btn-sm","btn-md","btn-lg"],options:{enum_titles:["Extra Small","Small","Medium","Large"]},default:"btn-md"},buttonlabel:{type:"string",default:"Button Label"},fullwidth:{type:"string",enum:["","btn-block"],options:{enum_titles:["Label Width","Column Width"]},default:""}}},BootstrapDoubleButton={title:"Multiple Buttons",id:"bootstrap.doubleButton",properties:{edit_mode:{type:"boolean",format:"hidden",default:!1},buttonsize:{type:"string",enum:["btn-xs","btn-sm","btn-md","btn-lg"],options:{enum_titles:["Extra Small","Small","Medium","Large"]},default:"btn-md"},buttonList:{type:"array",title:" ",format:"tabs",uniqueItems:!1,disable_collapse:!1,items:{type:"object",title:"Button",headerTemplate:"{{ i1 }}",extends:[BootstrapButton]},default:[{buttontype:"btn-primary",buttonlabel:"Button One",id:"",icon:"fa-dashboard",link:"http://bluntsoftware.com"},{buttontype:"btn-success",buttonlabel:"Button Two",id:"",icon:"fa-cube",link:"http://bluntsoftware.com"}]}}},BootstrapButtonGroup={title:"Button Group",id:"bootstrap.buttonGroup",extends:BootstrapDoubleButton,properties:{direction:{type:"string",enum:["btn-group","btn-group-vertical"],options:{enum_titles:["Horizontal","Vertical"]},default:""},justify:{type:"string",enum:["","btn-group-justified"],options:{enum_titles:["No","Yes"]},default:""}}},BootstrapJumbotron={id:"bootstrap.jumbotron",type:"object",title:"Jumbotron",extends:[BootstrapHeader,BootstrapText,BootstrapButton],properties:{header:{type:"string",default:"Hello, world!"},text:{type:"string",default:"This is a simple hero unit, a simple jumbotron-style component for calling extra attention to featured content or information."},buttonlabel:{type:"string",default:"Learn more"}}},counter=0,snippetTypes=new SnippetTypes,Snippet=Class.extend({init:function(a,b){this.name=a,this.kind=b,this.klass="Snippet",this.category="misc",this.icon="fa fa-edit",this.css=null,this.template="<div></div>",this.properties=this.getPropertyDefaults(),this.snip_id="snippet_"+counter++,this.edit_mode=!0,this.parent=null,this.private={parent:void 0}},privateVariables:function(a,b){if("snip_id"!=a&&"edit_mode"!=a&&"parent"!=a&&"private"!=a&&"service"!=a&&("_id"!=a&&"css"!=a||b))return b},afterRender:function(){var a=this;a.resize(),jQuery(window).on("load resize",function(){a.resize()})},findForm:function(){for(var a=this.private.parent;a;){if(a&&"SnippetForm"===a.klass&&a.properties&&a.properties.endpoint)return a;a=a.private.parent}return null},findEndPoint:function(){for(var a=this.private.parent;a;){if(a&&a.properties&&a.properties.endpoint)return a.properties.endpoint;a=a.private.parent}},resize:function(){if(this.properties.marginleft){var a=jQuery("#"+this.snip_id),b=$(window).width();$(window).height();b>768?a.css("margin-left",this.properties.marginleft):a.css("margin-left","0px")}},isEditMode:function(){},getProperties:function(){return this.properties},getPropertyDefaults:function(){var a={};if(document.getElementById("temp")instanceof Element){var b=this.schema();if(b)try{var c=new JSONEditor(document.getElementById("temp"),{schema:b});a=c.getValue(),a||(a={}),c.destroy()}catch(a){console.log(a)}}return a},schema:function(){return snippetTypes.getSchema(this.kind)},render:function(){var a=jQuery(this.processTemplate());return this.edit_mode?jQuery("<div></div>").attr("id",this.snip_id).addClass("selectable").addClass("moveable").append(a):a},processTemplate:function(){try{var a=$.extend({edit_mode:this.edit_mode,snip_id:this.snip_id},this.properties);return Handlebars.compile(this.template)(a)}catch(a){alert(a)}},isComponentContainer:function(){return!1},setCss:function(a){a&&(this.css=a)},setKlass:function(a){this.klass=a},compileCSS:function(){var a={};return this.css&&""!==this.css&&(a[this.kind]=this.css),a},toCSS:function(){var a="",b=this.compileCSS();return $.each(b,function(b,c){a+=c}),a},propertiesChanged:function(){},getSessionVars:function(){var a=this.getRoot();return a.private.sessionvars},getRoot:function(){for(var a=this,b=this;a;)a=a.private.parent,a&&(b=a);return b},execute:function(data){this.javascript="function sayHello(){ console.log(data);};sayHello();";var data={cool:"fred"};if(this.javascript)var result=eval(this.javascript)},isContainer:function(){return this.snippets},setParent:function(a){return this.parent=a.snip_id,this.private||(this.private={}),this.private.parent=a,this},showBorders:function(){jQuery(".border_control").addClass("border_position")},hideBorders:function(){jQuery(".border_control").removeClass("border_position")},setTemplate:function(a){this.template=a},setCategory:function(a){this.category=a},getCategory:function(){return this.category},setIcon:function(a){this.icon=a},flatten:function(a){var b={};for(var c in a)a.hasOwnProperty(c)&&"function"!=typeof a[c]&&(b[c]=a[c]);return b},setVal:function(a,b,c){a?c&&"undefined"!==c?(console.log("Setting old text for "+a+"from "+this.properties.list[c][a]+" to "+b+" for "+this.snip_id+" index "+c),this.properties.list[c][a]=b):(console.log("Setting old text for "+a+"from "+this.properties[a]+" to "+b+" for "+this.snip_id),this.properties[a]=b):alert("Name Value Pair only")},save:function(){JSON.stringify(this)},clone:function(){var newObj=eval("new "+this.klass+"()");return newObj=jQuery.extend(!0,newObj,this)},setEditMode:function(a){return this.edit_mode=a,this}}),SnippetField=Snippet.extend({init:function(a,b){this._super(a,b),this.klass="SnippetField",this.type="SnippetField"},afterRender:function(){}}),SnippetContainer=Snippet.extend({init:function(a,b){this._super(a,b),this.klass="SnippetContainer",this.height=100,this.snippets=[],this._id=null,this.private.sessionvars={id:null,name:null}},addSessionVars:function(a){this.private.sessionvars=jQuery.extend(this.private.sessionvars,a)},isComponentContainer:function(){return!0},move:function(a,b){this.snippets.move(a,b)},snippetIndex:function(a){for(var b=0;b<this.snippets.length;b++){var c=this.snippets[b];if(c.snip_id===a)return b}return null},listByKlass:function(a,b){b||(b=[]);for(var c=0;c<this.snippets.length;c++){var d=this.snippets[c];d.klass===a&&b.push(d),d.isContainer()&&d.listByKlass(a,b)}return b},listForms:function(){return this.listByKlass("SnippetForm")},findFieldsByEndpoint:function(a,b){for(var c=0;c<this.snippets.length;c++){var d=this.snippets[c];d.isContainer()?d.findFieldsByEndpoint(a,b):d.findEndPoint()===a&&b.push(d)}},renderContainer:function(){
var a=this,b=jQuery("<div></div>");return this.edit_mode&&(b.addClass("container-padding"),b.css("min-height",this.height).css("height","100%").attr("id",this.snip_id).addClass("selectable").addClass("sortable"),a.snippets.length<1&&(a.parent?b.html(jQuery("<h4>Empty</h4>").css("color","lightgray").css("text-align","center")):b.html(jQuery("<h2>Drag and Drop Or Double Click a Snippet</h2>").css("color","lightgray").css("text-align","center")))),this.edit_mode||b.find(":hasClassStartingWith('editable-')").alterClass("editable-*"),b},afterRender:function(){jQuery.each(this.snippets,function(a,b){try{b.afterRender()}catch(a){alert(a)}}),this._super()},render:function(a){var b=this,c=this.renderContainer();return jQuery.each(this.snippets,function(a,d){d?c.append(d.render()):b.snippets.splice(a,1)}),a?(a=jQuery(a).html(c),this.afterRender(),a):c},compileCSS:function(){var a=this,b={};return jQuery.each(this.snippets,function(c,d){d?b=$.extend(b,d.compileCSS()):a.snippets.splice(c,1)}),b},add:function(a,b){try{if(a.snip_id)return a.setParent(this),this.snippets.push(a),b&&this.snippets.move(this.snippets.length-1,0),this}catch(b){console.log(b),console.log(a)}},setEditMode:function(a){this.edit_mode=a,jQuery.each(this.snippets,function(b,c){c.setEditMode(a)})},remove:function(a){if("SnippetCol"===a.klass&&a.parent)this.remove({klass:"SnippetRow",snip_id:a.parent});else for(var b=0;b<this.snippets.length;b++){var c=this.snippets[b];a.snip_id===c.snip_id?this.snippets.splice(b,1):c.isContainer()&&c.remove(a)}},getByName:function(a){var b=null;if(a===this.name)return this;for(var c=0;c<this.snippets.length;c++){var d=this.snippets[c];if(d.name===a)return d;if(d.isContainer()&&(b=d.getByName(a),null!==b))return b}return b},getById:function(a){var b=null;if(a===this.snip_id)return this;for(var c=0;c<this.snippets.length;c++){var d=this.snippets[c];if(d.snip_id===a)return d;if(d.isContainer()&&(b=d.getById(a),null!==b))return b}return b},clone:function(){return this.loadObject(this)},save:function(){return JSON.stringify(this,this.privateVariables)},saveObject:function(){return JSON.parse(this.save())},load:function(a){var b=JSON.parse(a);return this.loadObject(b)},loadObject:function(obj){var newObj=eval("new "+obj.klass+"()"),item=jQuery.extend(newObj,obj);return obj._id&&(item._id=obj._id),item.isContainer()&&(item.snippets=[],item.loadChildren(obj)),item},loadChildren:function(container){var that=this;jQuery.each(container.snippets,function(index,snippet){if(snippet&&snippet.klass){var item=eval("new "+snippet.klass+"()");jQuery.extend(!0,item,snippet),item.isContainer()&&(item.snippets=[],item.loadChildren(snippet)),that.add(item)}})}}),SnippetForm=SnippetContainer.extend({init:function(a,b){this._super(a,b),this.klass="SnippetForm",this.type="SnippetForm"},schema:function(){return{id:"bootstrap.form",type:"object",title:"Panel",extends:[BootstrapHeader,BootstrapFooter],properties:{endpoint:{title:"Rest URL",type:"string",default:"./restapi",format:"endpointChooser"},header:{type:"string",default:"Form Header"},footer:{type:"string",default:"Form Footer"},marginleft:{type:"string",default:"0px"},panelColor:{type:"string",enum:["panel-default","panel-warning","panel-success","panel-primary","panel-info","panel-danger"],options:{enum_titles:["Default","Warning","Success","Primary","Info","Danger"]},default:"panel-default"}}}},afterRender:function(){this._super(),this.refreshData()},refreshData:function(){var a=this,b=this.getSessionVars().id,c=jQuery("#"+this.snip_id);if(b&&""!==b){c.attr("data-id",b);var d=new RestCollection(window.serverConfig.getEndpoint(this.properties.endpoint));d.getById(b,function(b){a.fillForm(b)})}},fillForm:function(data){var self=this,form=jQuery("#"+this.snip_id);jQuery.expr[":"].parents=function(a,b,c){return jQuery(a).parents(c[3]).length<1},form.find("[name]").filter(":parents(.form-list)").each(function(){try{var val=eval("data."+jQuery(this).attr("name"));val&&jQuery(this).val(val).change()}catch(a){console.log("SnippetForm:fillForm -> "+a)}})},getFields:function(){var a=[];return this.findFieldsByEndpoint(this.properties.endpoint,a),console.log(a),a},submitForm:function(){var a=$.Deferred(),b=this,c=jQuery("#"+this.snip_id),d=(c.attr("data-id"),this.getFields()),e={},f=!0;if($.each(d,function(a,b){var d=b.properties.name;if(d){var g=c.find('[name="'+d+'"]').val();b.properties.required&&!g?(c.find('[name="'+d+'"]').css("border-color","red").css("border-width","1px").css("border-style","solid"),f=!1):c.find('[name="'+d+'"]').css("border-color","black"),e[d]=g}}),console.log("Validation Complete"),f){var g=new RestCollection(window.serverConfig.getEndpoint(this.properties.endpoint));g.save(e).done(function(c){b.fillForm(c),a.resolve(c)}).error(function(a){console.log(a)})}return a.promise()},render:function(){var a=jQuery("<div></div>").addClass("panel").addClass("{{panelColor}}");a.attr("id",this.snip_id),this.edit_mode&&(a.addClass("selectable"),a.addClass("container-padding"),a.addClass("moveable"));var b=jQuery("<div></div>").addClass("panel-heading"),c=jQuery("<p></p>").addClass("editable-header");c.append("{{{header}}}"),b.append(c),a.append(b);var d=this._super();d.addClass("panel-body"),a.append(d);var e=jQuery("<div></div>").addClass("panel-footer editable-footer");e.append("{{{footer}}}"),a.append(e);var f=Handlebars.compile(jQuery("<div></div>").append(a).html());return jQuery(f(this.properties))}}),SnippetFormList=SnippetContainer.extend({init:function(a,b){this._super(a,b),this.klass="SnippetFormList",this.type="SnippetFormList"},schema:function(){return{id:"bootstrap.form",type:"object",title:"Form List",properties:{endpoint:{title:"Rest URL",type:"string",default:"./restapi",format:"endpointChooser"},label:{type:"string",default:"Label"},readonly:{type:"boolean",enum:[!1,!0],options:{enum_titles:["No","Yes"]},default:!1},marginleft:{type:"string",default:"0px"},criteria:{title:"Criteria",type:"array",format:"table",uniqueItems:!0,disable_collapse:!1,items:{type:"object",title:"Option",headerTemplate:"{{ i1 }}",properties:{field:{type:"string",format:"columns",default:"id",watch:{endpoint:"endpoint"}},operator:{type:"string",enum:["eq","icn","be","ew","gt","lt"],options:{enum_titles:["Equals","Contains","Begins With","Ends With","Greater Then","Less Then"]},default:"eq"},value:{type:"string",format:"fieldChooser",default:"id"}}},default:[]}}}},getFieldValue:function(a){var b=this,c=void 0;return jQuery("#view-content").find("[name='"+a+"']").each(function(){var a=jQuery(this).val();a&&(c=a)}).change(function(){b.refreshFormList()}),c},getQuery:function(){var a=this,b=window.serverConfig.getEndpoint(this.properties.endpoint);this.service=new PagedCollection(b);var c=this.service.qry();return this.properties.criteria&&$.each(this.properties.criteria,function(b,d){var e=a.getFieldValue(d.value);c.add(d.field,d.operator,e)}),c},submitFormList:function(){var a=[];if(!this.properties.readonly){var b=this,c=jQuery("#list"+this.snip_id).find(".form-row"),d=new RestCollection(window.serverConfig.getEndpoint(b.properties.endpoint));c.each(function(){var c=$.Deferred(),e={id:$(this).attr("data-id")};$(this).find("[name]").each(function(){var a=$(this).attr("name");e[a]=$(this).val()}),b.properties.criteria&&$.each(b.properties.criteria,function(a,c){var d=b.getFieldValue(c.value);e[c.field]=d}),d.save(e).done(function(b){a.push(c)}).error(function(a){console.log(a)})})}return $.when.apply($,a).promise()},refreshFormList:function(){if(!this.edit_mode){var self=this,formTemplate=this.private.form_template,snippet=jQuery("#list"+self.snip_id),panelBody=snippet.find(".form-list");this.getQuery().find().done(function(json){panelBody.empty(),$.each(json.rows,function(idx,data){var formRow=jQuery('<div data-id="'+data.id+'"></div>').addClass("form-row"),form=jQuery(formTemplate).clone();form.find("[name]").each(function(){try{var jPath="data."+jQuery(this).attr("name"),val=eval(jPath);jQuery(this).val(val).change()}catch(a){console.log(a)}}),formRow.append(form),panelBody.append(formRow)})}).complete(function(){})}},addEmptyRow:function(){var a=this,b=jQuery("#list"+a.snip_id),c=b.find(".form-list"),d=jQuery("<div></div>").addClass("form-row");d.append(this.private.form_template),c.append(d)},afterRender:function(){console.log("afterRender");var a=this;jQuery("#list"+a.snip_id).find(".add-empty-row").unbind("click").bind("click",function(){console.log("Click add Empty Row"),a.addEmptyRow()}),this.properties.criteria&&this.properties.criteria.length>0?(console.log(this.properties.criteria),$.each(this.properties.criteria,function(b,c){$('[name="'+c.value+'"]').unbind("change."+a.snip_id).bind("change."+a.snip_id,function(){a.refreshFormList()})})):a.refreshFormList()},render:function(){var a=jQuery("<div></div>");if(a.attr("id","list"+this.snip_id),this.edit_mode&&(a.addClass("selectable"),a.addClass("container-padding"),a.addClass("moveable")),this.properties.readonly||a.append('<i class="add-empty-row fa fa-plus-square-o pull-right"></i>'),this.properties.label){var b=jQuery("<label></label>").addClass("editable-label");b.append(this.properties.label),a.append(b)}var c=jQuery("<div></div>").addClass("form-list");this.private.form_template=this._super();var d=jQuery("<div></div>").addClass("form-row");return d.append(this.private.form_template),c.append(d),a.append(c),jQuery("<div></div>").append(a)}}),SnippetCol=SnippetContainer.extend({init:function(a){this._super(a),this.klass="SnippetCol",this.type="SnippetCol"}}),SnippetRow=SnippetContainer.extend({init:function(a){this._super(a),this.klass="SnippetRow",this.height=100,this.columns="12",this.type="SnippetRow"},getColumns:function(){var a=this.columns.split(" "),b=0;if(jQuery.each(a,function(a,c){b+=Number(c)}),12!==b){var c=a.length;switch(c){case 2:a=[6,6];break;case 3:a=[4,4,4];break;case 4:a=[3,3,3,3]}}return a},adjustColumns:function(a,b){var c=this.snippetIndex(a),d=c+1,e=this.getColumns();if(e[d]){var f=Number(e[c])+Number(e[c+1]);e[c]=Number(e[c])+b,e[d]=Number(e[d])+b*-1,e[d]<1&&(e[d]=1,e[c]=f-1),e[c]<1&&(e[c]=1,e[d]=f-1)}var g=this;jQuery.each(e,function(a,b){0==a?g.columns=b:g.columns+=" "+b})},renderRow:function(){var a=jQuery("<div></div>").addClass("row");return this.edit_mode&&(a.addClass("container-padding"),a.attr("id",this.snip_id).addClass("moveable")),a},render:function(){var a=this,b=this.renderRow(),c=this.getColumns();return this.snippets.length<1&&jQuery.each(c,function(b,c){var d=new SnippetCol;console.log(d),a.add(d)}),jQuery.each(this.snippets,function(d,e){var f=e.render().addClass("col-sm-"+c[d]);a.edit_mode&&f.addClass("border_position").addClass("resizeable"),b.append(f)}),b}}),SnippetRow2Col=SnippetRow.extend({init:function(a){this._super(a),this.klass="SnippetRow2Col",this.columns="2 10"}}),SnippetRow3Col=SnippetRow.extend({init:function(a){this._super(a),this.klass="SnippetRow3Col",this.columns="4 4 4"}}),SnippetRow4Col=SnippetRow.extend({init:function(a){this._super(a),this.klass="SnippetRow4Col",this.columns="3 3 3 3"}}),SnippetTabContainer=SnippetContainer.extend({init:function(a){this._super(a),this.klass="SnippetTabContainer",this.type="SnippetTabContainer"},isComponentContainer:function(){return!1}}),SnippetTabRow=SnippetContainer.extend({init:function(a){this._super(a),this.klass="SnippetTabRow",this.height=100,this.type="SnippetTabRow",this.activeTab=0},add:function(a,b,c){try{if(a.klass===this.klass)return this._super(new SnippetTabContainer("Tab "+(this.snippets.length+1))),this;if("SnippetTabContainer"===a.klass)this._super(a,b);else{var d=this.snippets[this.activeTab];d&&d.isContainer()&&d.add(a,b)}}catch(b){console.log(b),console.log(a)}},setVal:function(a,b,c){this.snippets[this.activeTab].setVal(a,b,c)},render:function(){var a=this,b=jQuery("<div></div>").addClass("tabbable").addClass("selectable");if(b.addClass("container-padding"),this.edit_mode&&b.attr("id",this.snip_id).addClass("moveable"),this.snippets.length<1){var c=new SnippetTabContainer("Tab 1");a.add(c,!1,!0)}var d=jQuery("<ul></ul>").addClass("nav").addClass("nav-tabs").attr("role","tablist"),e=jQuery("<div></div>").addClass("tab-content");return jQuery.each(this.snippets,function(b,c){var f=null;c.properties&&(f=c.properties.label),f&&""!==f||(f="Tab "+b);var g=jQuery("<a></a>").addClass("editable-label").attr("data-target","#"+c.snip_id).attr("data-toggle","tab").html(f);b==a.activeTab&&g.addClass("active"),d.append(jQuery("<li></li>").append(g));var h=c.render();h.addClass("tab-pane").attr("role","tabpanel").removeClass("sortable").attr("id",c.snip_id),h.find(".resizeable").removeClass("resizeable").addClass("hiddentab"),b==a.activeTab&&(h.addClass("active").addClass("sortable"),h.find(".hiddentab").addClass("resizeable").removeClass("hiddentab")),e.append(h)}),b.append(d),b.append(e),b}}),SnippetPanel=SnippetContainer.extend({init:function(a,b){this._super(a,b),this.klass="SnippetPanel",this.height=100,this.type="SnippetPanel",this.content=null},render:function(){var a=jQuery("<div></div>").addClass("panel").addClass("{{panelColor}}").addClass("selectable");a.addClass("container-padding"),this.edit_mode&&a.attr("id",this.snip_id).addClass("moveable");var b=jQuery("<div></div>").addClass("panel-heading editable-header");b.append("{{{header}}}"),a.append(b);var c=this._super();c.addClass("panel-body"),a.append(c);var d=jQuery("<div></div>").addClass("panel-footer editable-footer");d.append("{{{footer}}}"),a.append(d);var e=Handlebars.compile(jQuery("<div></div>").append(a).html());return jQuery(e(this.properties))}}),SnippetNavBarItem=Snippet.extend({init:function(a,b){this._super(a,b),this.klass="SnippetNavBarItem"},schema:function(){return{title:"Navigation Bar Item",id:"bootstrap.navItem",extends:this._super(),properties:{label:{type:"string",default:"Link"},link:{type:"string",format:"link",default:"http://bluntsoftware.com"},type:{type:"string",enum:["link","dropdown","button","search"],options:{enum_titles:["link","dropdown","button","search"]},default:"link"},icon:{type:"string",format:"icon",default:""},location:{type:"string",enum:["navbar-left","","navbar-right"],options:{enum_titles:["Left","Center","Right"]},default:""}}}},render:function(){var a=jQuery("<li></li>"),b=jQuery("<a></a>");return this.properties.icon&&b.append('<span class="fa '+this.properties.icon+'"></span>'),b.append("&nbsp;"+this.properties.label),a.append(b),this.edit_mode?(a.addClass("sortable"),b.attr("id",this.snip_id).addClass("selectable")):b.attr("href",this.properties.link),a}}),SnippetNavBar=SnippetContainer.extend({init:function(a,b){this._super(a,b),this.klass="SnippetNavBar",this.type="SnippetNavBar"},schema:function(){return{title:"Navigation Bar",id:"bootstrap.nav",extends:this._super(),properties:{Brand:{type:"string",default:"Brand"},Image:{type:"string",default:null},image_class:{type:"string",default:null},img_height:{type:"number",default:30},img_width:{type:"number",default:30},link:{type:"string",format:"link",default:"http://bluntsoftware.com"},Inverse:{type:"boolean",default:!1},location:{type:"string",enum:["navbar-fixed-top","navbar-fixed-bottom","navbar-static-top","navbar-static"],options:{enum_titles:["Fixed Top","Fixed Bottom","Static Top","Static"]},default:"navbar-fixed-top"}}}},add:function(a,b){try{"SnippetNavBarItem"===a.klass&&this._super(a,b)}catch(b){console.log(b),console.log(a)}},render:function(){var a=jQuery("<div></div>"),b=jQuery('<nav role="navigation"></nav>');a.attr("id",this.snip_id),b.addClass("navbar navbar-default"),b.css("padding-right","25px"),this.properties.Inverse===!0&&b.addClass("navbar-inverse");var c=$("body");c.css("padding-top","0px"),c.css("padding-bottom","0px"),this.edit_mode?(a.addClass("container-padding"),a.addClass("selectable"),b.addClass("sortable")):("navbar-fixed-top"===this.properties.location&&c.css("padding-top","50px"),"navbar-fixed-bottom"===this.properties.location&&c.css("padding-bottom","50px"),b.addClass(this.properties.location));var d=jQuery('<div class="navbar-header"><button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#top_navbar"><span class="sr-only">Toggle navigation</span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button></div>'),e=jQuery('<a class="navbar-brand"></a>');if(this.properties.link&&!this.edit_mode&&e.attr("href",this.properties.link),this.properties.Image){var f=jQuery('<img alt="Brand">');f.addClass(this.properties.image_class),f.attr("src",this.properties.Image).attr("height",this.properties.img_height).attr("width",this.properties.img_width),e.append(f)}else this.properties.Brand&&e.append(this.properties.Brand);d.append(e);var g=jQuery('<div class="collapse navbar-collapse" id="top_navbar"></div>'),h=jQuery('<ul class="nav navbar-nav navbar-left"></ul>'),i=jQuery('<ul class="nav navbar-nav"></ul>'),j=jQuery('<ul class="nav navbar-nav navbar-right"></ul>');return jQuery.each(this.snippets,function(a,b){"navbar-left"==b.properties.location?h.append(b.render()):"navbar-right"==b.properties.location?j.append(b.render()):i.append(b.render())}),g.append(h),g.append(i),g.append(j),b.append(d),b.append(g),a.append(b),a}}),SnippetTable=Snippet.extend({init:function(a,b){this._super(a,b),this.klass="SnippetTable",this.type="SnippetTable"},schema:function(){return{title:"Table Properties",id:"bootstrap.table",properties:{endpoint:{title:"Rest URL",type:"string",default:"",format:"endpointChooser"},rows:{title:"Max Rows",type:"number",default:20},hover:{title:"Hover",type:"boolean",default:"true"},striped:{title:"Stripe Rows",type:"boolean",default:"true"},bordered:{title:"Border",type:"boolean",default:"true"},marginleft:{type:"string",default:"0px"},label:{title:"Label",type:"string",default:""},condensed:{title:"Condense Rows",type:"boolean",default:!0},responsive:{title:"Scroll Columns",type:"boolean",default:!1},add_form:{title:"Add Form",type:"string",format:"link",default:""},edit_form:{title:"Edit Form",type:"string",format:"link",default:""},sidx:{title:"Sort Index",type:"string",format:"columns",default:"id",watch:{endpoint:"endpoint"}},sord:{title:"Sort Order",type:"string",enum:["ASC","DESC"],options:{enum_titles:["Ascending","Descending"]},default:"ASC"},columns:{title:"Columns",type:"array",format:"table",uniqueItems:!0,disable_collapse:!1,items:{type:"object",title:"Option",headerTemplate:"{{ i1 }}",properties:{label:{type:"string",default:"Id"},name:{type:"string",format:"columns",default:"id",watch:{endpoint:"endpoint"}},format:{title:"Format",type:"string",enum:["text","image","icon"],options:{enum_titles:["Text","Image","Icon"]},default:"text"}}},default:[{name:"id",label:"Id"}]},criteria:{title:"Criteria",type:"array",format:"table",uniqueItems:!0,disable_collapse:!1,items:{type:"object",title:"Option",headerTemplate:"{{ i1 }}",properties:{field:{type:"string",format:"columns",default:"id",watch:{endpoint:"endpoint"}},operator:{type:"string",enum:["eq","icn","be","ew","gt","lt"],options:{enum_titles:["Equals","Contains","Begins With","Ends With","Greater Then","Less Then"]},default:"eq"},value:{type:"string",format:"fieldChooser",default:"id"}}},default:[]}}}},propertiesChanged:function(){this.service=null},getColumns:function(a){a(this.properties.columns)},afterRender:function(){this._super();var a=this;this.properties.criteria&&$.each(this.properties.criteria,function(b,c){a.watchValueField(c.value)}),a.refresh()},watchValueField:function(a){var b=this;jQuery("#view-content").find("[name='"+a+"']").unbind("change.valuefield").bind("change.valuefield",function(){b.refresh()})},getFieldValue:function(a){var b=void 0;return jQuery("#view-content").find("[name='"+a+"']").each(function(){var a=jQuery(this).val();a&&(b=a)}),b},getRows:function(a){var b=this,c=window.serverConfig.getEndpoint(this.properties.endpoint);this.service&&$.isFunction(this.service.qry)&&c===this.service.url||(this.service=new PagedCollection(c),this.service.sord=b.properties.sord,this.service.sidx=b.properties.sidx,this.service.rows=b.properties.rows);var d=this.service.qry(),e=$("#"+this.snip_id);e.find(".filters").find("input").each(function(){var a=$(this).val().toLowerCase(),c=e.find(".filters th").index($(this).parents("th"));if(b.properties.columns[c]){var f=b.properties.columns[c].name;a&&d.icn(f,a)}}),this.properties.criteria&&$.each(this.properties.criteria,function(a,c){var e=b.getFieldValue(c.value);console.log("find where "+c.field+" "+c.operator+" "+e),d.add(c.field,c.operator,e)}),e.find(".search").find("input").each(function(){var a=$(this).val().toLowerCase();a&&jQuery.each(b.properties.columns,function(b,c){d.orMode().icn(c.name,a)})}),d.find(function(b){a&&a(b)})},filterFields:function(){var a=this,b=$("#"+this.snip_id);b.find(".btn-filter").unbind("click").bind("click",function(){var a=$(this).parents(".filterable"),b=a.find(".filters input"),c=a.find(".table tbody");1==b.prop("disabled")?(b.prop("disabled",!1),b.first().focus()):(b.val("").prop("disabled",!0),c.find(".no-result").remove(),c.find("tr").show())}),b.find(".filters").find("input").keyup(function(b){var c=b.keyCode||b.which;"9"!=c&&(a.service.setPage(1),a.getRows(function(b){a.drawTable(b)}))}),b.find(".search").find("input").keyup(function(b){var c=b.keyCode||b.which;"9"!=c&&(a.service.setPage(1),a.getRows(function(b){a.drawTable(b)}))})},refresh:function(a){var b=this;b.getRows(function(c){b.drawTable(c),b.filterFields(),a&&a(c)})},drawTable:function(data){var self=this,columns=self.properties.columns,rows=data.rows,body=jQuery("<tbody></tbody>");jQuery.each(rows,function(index,row){var tr=jQuery('<tr  id="'+row.id+'"></tr>');jQuery.each(columns,function(idx,column){var val=eval("row."+column.name);val||(val="");var format=column.format;if(format)switch(format){case"text":tr.append("<td>"+val+"</td>");break;case"image":tr.append('<td><img style="max-height:65px" src="'+val+'"/></td>')}else tr.append("<td>"+val+"</td>")}),body.append(tr)});var panel=$("#"+self.snip_id);panel.find(".page_number").html(data.currpage+" of "+data.totalpages);var info=jQuery("<span></span>").addClass("pull-right").html("found "+data.totalrecords+" records");panel.find(".record_count").html(info),panel.find(".pager_next").unbind("click").bind("click",function(){self.service.nextPage(),self.refresh()}),panel.find(".pager_prev").unbind("click").bind("click",function(){self.service.previousPage(),self.refresh()}),panel.find(".column_sort").unbind("click").bind("click",function(){self.service.toggleSort(),self.service.sidx=$(this).attr("data-sort"),self.refresh()}),panel.find("table").on("dblclick","tbody >tr",function(){var a=$(this).attr("id");self.properties.edit_form&&(window.location=self.properties.edit_form+"/"+a)});var table=panel.find("table");table.find("tbody").html(""),table.append(body)},render:function(){var a=this,b=jQuery('<div class="panel panel-default filterable"></div>');b.attr("id",this.snip_id),this.edit_mode&&(b.css("min-width","75px"),b.addClass("selectable"));var c=jQuery('<div class="input-group search"><input class="form-control input-sm" placeholder="Search for" ><span class="input-group-btn"><button type="submit" class="btn btn-round btn-sm btn-default"><i class="fa fa-search"></i></button><button class="btn btn-round btn-sm btn-default btn-filter"><i class="fa fa-filter"></i></button></span></div>');if(this.properties.label){var d=jQuery('<div class="panel-heading"></div>');d.append('<h3 class="panel-title">'+this.properties.label+"</h3>"),d.append(c),b.append(d)}var e=jQuery('<table class="table"></table>');this.properties.striped&&e.addClass("table-striped"),this.properties.bordered&&e.addClass("table-bordered"),this.properties.hover&&e.addClass("table-hover"),this.properties.condensed&&e.addClass("table-condensed");var f=jQuery("<thead></thead>"),g=jQuery('<tr class="filters"></tr>');jQuery.each(this.properties.columns,function(a,b){g.append('<th><div class="input-group input-group-unstyled"><input type="text" class="form-control input-sm" placeholder="'+b.label+'" disabled>  <span class="input-group-addon"><i data-sort="'+b.name+'" class="text-muted column_sort fa fa-sort"></i></span></div></th>')}),f.append(g),e.append(f),e.append("<tbody></tbody>").append("<tr><td>No Data Found</td></tr>");var h=jQuery('<div class="panel-body no-more-tables" ></div>');this.properties.responsive&&h.addClass("table-responsive"),h.append(e),b.append(h);var i=jQuery('<div class="panel-footer"></div>'),j=jQuery("<div></div>").addClass("col-sm-4");!this.properties.label;var k=jQuery("<div></div>").addClass("col-sm-4").addClass("text-center");k.append(jQuery('<div class="btn-group"><a type="button" class="btn btn-xs btn-round btn-default pager_prev">Prev</a><a type="button" class="btn btn-xs btn-default page_number">1</a><a type="button" class="btn btn-xs btn-round btn-default pager_next">Next</a></div>'));var l=jQuery('<div class="record_count"></div>').addClass("col-sm-4"),m=jQuery("<div></div>").addClass("row").addClass("container-padding");return m.append(j),m.append(k),m.append(l),i.append(m),b.append(i),a.template=b.html(),b}}),SnippetButton=Snippet.extend({init:function(a,b){this._super(a,b),this.klass="SnippetButton",this.type="SnippetButton"},afterRender:function(){var a=this;jQuery('[data-id="'+this.snip_id+'"]').find('[role="button"]').unbind("click").bind("click",function(b){b.preventDefault();var c=$(this).attr("href"),d=a.properties;if(d.buttonList){var e=Number($(this).attr("data-idx"));d=d.buttonList[e]}a.submitForm(d).done(function(b){a.submitFormLists().done(function(){c&&(window.location=c)})})})},submitFormLists:function(){var a=[],b=[];return this.getRoot().listByKlass("SnippetFormList",a),$.each(a,function(a,c){b.push(c.submitFormList())}),$.when.apply($,b).promise()},submitForm:function(a){var b=$.Deferred();return a.submit?$.each(this.getRoot().listForms(),function(c,d){d.properties.endpoint===a.submit&&d.submitForm().done(function(a){b.resolve(a)})}):b.resolve(),b.promise()}}),SnippetSearchField=Snippet.extend({init:function(a,b){this._super(a,b),this.klass="SnippetSearchField",this.type="SnippetSearchField"},schema:function(){return{title:"Search Field",id:"bootstrap.search.field",type:"object",extends:BootstrapField,properties:{endpoint:{title:"Rest URL",type:"string",default:"./restapi",format:"endpointChooser"},multiple:{type:"string",enum:["","multiple"],options:{enum_titles:["No","Yes"]},default:""},field_value:{type:"string",format:"columns",default:"id",watch:{endpoint:"endpoint"}},display_value:{title:"display_value",type:"array",format:"table",uniqueItems:!0,disable_collapse:!1,items:{type:"object",title:"Add To Display Value",headerTemplate:"{{ i1 }}",properties:{display_field:{type:"string",format:"columns",default:"id",watch:{endpoint:"endpoint"}}}},default:[]},criteria:{title:"Criteria",type:"array",format:"table",uniqueItems:!0,disable_collapse:!1,items:{type:"object",title:"Add Criteria",headerTemplate:"{{ i1 }}",properties:{field:{type:"string",format:"columns",default:"id",watch:{endpoint:"endpoint"}},operator:{type:"string",enum:["eq","icn","be","ew","gt","lt"],options:{enum_titles:["Equals","Contains","Begins With","Ends With","Greater Then","Less Then"]},default:"eq"},value:{type:"string",format:"fieldChooser",default:"id"}}},default:[]},field_map:{title:"Field Map",type:"array",format:"table",uniqueItems:!0,disable_collapse:!1,items:{type:"object",title:"Add Field Map",headerTemplate:"{{ i1 }}",properties:{source:{type:"string",format:"columns",default:"id",watch:{endpoint:"endpoint"}},target:{type:"string",format:"fieldChooser",default:"id"}}},default:[]}}}},render:function(){var a=jQuery("<div></div>").attr("id",this.snip_id);this.edit_mode&&a.addClass("selectable").addClass("moveable");var b=jQuery("<div></div>").addClass("control-group"),c=jQuery("<label></label>").addClass("control-label editable-label").html(this.properties.label),d=jQuery('<div class="controls"></div>'),e=jQuery("<select></select>").attr("id",this.properties.id).attr("name",this.properties.name).addClass("form-control").addClass(this.properties.classes).addClass(this.properties.inputsize);return e.append('<option value="">New</option>'),d.append(e),b.append(c),b.append(d),a.append(b),a},afterRender:function(){var self=this,url=window.serverConfig.getEndpoint(this.properties.endpoint),collection=new PagedCollection(url),select=$("#"+this.snip_id).find("select");collection.find().done(function(data_list){$.each(data_list.rows,function(a,b){var c="";$.each(self.properties.display_value,function(a,d){c+=b[d.display_field]}),select.append('<option value="'+b[self.properties.field_value]+'">'+c+"</option>")});var form=self.findForm();form&&(console.log(form),form.refreshData()),select.unbind("change").bind("change",function(){collection.qry().eq("id",$(this).val()).find().done(function(item){$.each(self.properties.field_map,function(idx,data){try{var found=eval("item.rows[0]."+data.source);$('[name="'+data.target+'"').val(found)}catch(a){console.log(a)}})})})})}});!function(){function a(){this.editor=null}return a.prototype.init=function(){var a=this,b=$.Deferred();return this.loadConnections().done(function(b){a.connections=b.connections}).complete(function(){a.connections||(base_url||(base_url="../"),a.connections={self:{url:base_url}}),b.resolve()}),b.promise()},a.prototype.menu=function(a,b){var c=jQuery('<ul class="dropdown-menu scrollable-menu"></ul>');return $.each(a,function(a){var d=b+"/"+a;c.append(jQuery('<li class="endpoint-menu-item" id="'+d+'"><a href="#">'+a+"</a></li>"))}),c},a.prototype.subMenu=function(){return jQuery('<ul role="menu" class="dropdown-menu multi-level"></ul>')},a.prototype.subMenuLineItem=function(a){return jQuery('<li class="dropdown-submenu"></li>').append('<a tabindex="-1" href="#">'+a+"</a>")},a.prototype.buildDropList=function(){var a=this,b=a.subMenu(),c=$.Deferred();return this.connectionList().done(function(d){$.each(d,function(c,d){var e=a.subMenuLineItem(c),f=a.subMenu();$.each(d,function(b,d){var e=a.subMenuLineItem(b).append(a.menu(d,c+"/"+b));f.append(e)}),e.append(f),b.append(e)}),c.resolve(b)}),c.promise()},a.prototype.connectionList=function(){var a=this,b=$.Deferred(),c={};return $.each(this.connections,function(d,e){a.mods(d).done(function(a){c[d]=a.mods}).error(function(){c[d]={bad_connection:{connection:e.url}}}).complete(function(){Object.keys(c).length===Object.keys(a.connections).length&&b.resolve(c)})}),b.promise()},a.prototype.mods=function(a){return new RestCollection(this.connections[a].url+"/api").find()},a.prototype.getEndpoint=function(a){if(a.startsWith("http")||a.startsWith("../"))return a;var b=a.split("/");return b.length>2&&this.connections[b[0]]?this.connections[b[0]].url+"/"+b[1]+"/"+b[2]:a},a.prototype.showServerConfig=function(){var a=this,b=$("<div></div>");b.load("lacet/editor/lacet_connections.html",function(){bootbox.dialog({title:"Server Config",message:b,size:"large",className:"ServerConfig",buttons:{success:{label:"Save",className:"btn-success",callback:function(){a.saveServerConfig()}}}}),$(".addConnection").unbind("click").bind("click",function(){var b=$('[name="name"]').val(),c=$('[name="url"]').val();a.connections[b]={url:c},a.renderConnectionList()}),a.renderConnectionList()})},a.prototype.renderConnectionList=function(){var a=this,b=jQuery("#connection_list");b.empty(),$.each(this.connections,function(a,c){var d=jQuery('<tr class="connection_row"></tr>');d.append("<td>"+a+"</td>"),d.append("<td>"+c.url+"</td>"),"self"!=a&&d.append('<td><i id="'+a+'" class="remove_connection fa fa-remove"></i></td>'),b.append(d)}),$(".connection_row").unbind("click").bind("click",function(){$('[name="name"]').val($($(this).find("td").get(0)).html()),$('[name="url"]').val($($(this).find("td").get(1)).html())}),$(".remove_connection").unbind("click").bind("click",function(){var b=$(this).attr("id");delete a.connections[b],a.renderConnectionList()})},a.prototype.loadConnections=function(){return window.connections.qry().getById("server_config");
},a.prototype.saveServerConfig=function(){var a={_id:"server_config",connections:this.connections};window.connections.save(a)},window.serverConfig=new a,jQuery(function(){window.serverConfig.init()}),window.serverConfig}(jQuery),function(){function LacetEastPanel(){}return LacetEastPanel.prototype.init=function(){var a=this,b=$.Deferred();return $("#east-panel").load("lacet/editor/lacet_east_panel.html",function(c,d,e){$(".server_config").unbind("click").bind("click",function(){window.serverConfig.showServerConfig()}),a.refreshStockTemplates().done(function(){b.resolve(),a.loadPages(),a.initPageEvents()})}),b.promise()},LacetEastPanel.prototype.refreshStockTemplates=function(){var a=this,b=$.Deferred();return a.loadSnippets("lacet/templates/snippet_templates.hbs").done(function(c){a.templates=c,a.appendSnippets(),a.refreshCustomTemplates().done(function(){b.resolve()})}),b.promise()},LacetEastPanel.prototype.refreshCustomTemplates=function(){var a=this,b=$.Deferred();return window.snippetBuilder.loadCustomSnippets(function(c){a.customTemplates=c,a.appendCustomSnippets(),a.initSnippetEvents(),b.resolve()}),b.promise()},LacetEastPanel.prototype.getSnippetByName=function(a){var b=this.templates.getByName(a);return b||(b=this.customTemplates.getByName(a)),b},LacetEastPanel.prototype.initSnippetEvents=function(){this.initDoubleClickSnippet(),this.initDragSnippet(),this.initCustomSnippetEvents()},LacetEastPanel.prototype.appendCustomSnippets=function(){var a=this;jQuery("#custom-snippet").empty();var b=a.getCategoryHtml(a.customTemplates.snippets,!0);jQuery.each(b,function(a){jQuery("#custom-snippet").append(b[a])})},LacetEastPanel.prototype.getCustomSnippetMenuItem=function(a,b,c){var d=jQuery('<li class="dropbang"></li>').attr("klass",b).attr("id",a),e=jQuery('<a type="button" class="tool"></a>').attr("klass",b).attr("title",b);return e.append(jQuery("<i></i>").addClass(c)),e.append(jQuery("<span></span>").addClass("nav-label").html(b)),e.append(jQuery('<i class="menuIcon removeCustomSnippet" ></i>').addClass("fa fa-remove fa-lg pull-right")),e.append(jQuery('<i class="menuIcon viewCustomSnippet" ></i>').addClass("fa fa-eye fa-lg pull-right")),d.append(e),d},LacetEastPanel.prototype.initCustomSnippetEvents=function(){var a=this;jQuery("#newSnippet").unbind("click").bind("click",function(b){b.stopPropagation(),window.snippetBuilder.newCustomSnippet().done(function(){a.refreshCustomTemplates()})}),jQuery(".removeCustomSnippet").unbind("click").bind("click",function(a){a.stopPropagation();var b=$(this).parent().parent().attr("id");window.snippetBuilder.removeCustomSnippet(b)}),jQuery(".viewCustomSnippet").unbind("click").bind("click",function(b){b.stopPropagation();var c=$(this).parent().parent().attr("id");console.log(c),window.snippetBuilder.editCustomSnippet(c).done(function(){a.refreshCustomTemplates()})})},LacetEastPanel.prototype.loadSnippets=function(a){var b=$.Deferred(),c=new SnippetContainer("SnippetList");c.setEditMode(!1);var d=this;return jQuery("#temp").load(a,function(){jQuery('script[type="text/template"]').each(function(a,b){var e=d.loadSnippetTemplate(b);e&&c.add(e)}),b.resolve(c)}),b.promise()},LacetEastPanel.prototype.loadSnippetTemplate=function(template){try{var klass=template.getAttribute("klass"),kind=template.getAttribute("kind"),name=template.getAttribute("name"),snippet=eval("new "+klass+"('"+name+"','"+kind+"')");if(snippet)return snippet.setKlass(klass),snippet.setCategory(template.getAttribute("category")),snippet.setIcon(template.getAttribute("icon")),snippet.setTemplate(template.innerHTML),snippet}catch(a){console.log(a)}return null},LacetEastPanel.prototype.appendSnippets=function(){jQuery("#side-menu").empty();var a=this.getCategoryHtml(this.templates.snippets);jQuery.each(a,function(b){jQuery("#side-menu").append(a[b])})},LacetEastPanel.prototype.getMenuItem=function(a,b){var c=jQuery('<li class="dropbang"></li>').attr("klass",a),d=jQuery('<a type="button" class="tool"></a>').attr("klass",a).attr("title",a);return d.append(jQuery("<i></i>").addClass(b)),d.append(jQuery("<span></span>").addClass("nav-label").html(a)),c.append(d),c},LacetEastPanel.prototype.getCategoryHtml=function(a,b){var c=this,d={},e=$("#snippetSearch").val();return jQuery.each(a,function(a,f){var g=!1,h=f.name;if(e&&""!=e||(g=!0),!g&&e&&h.toLowerCase().indexOf(e.toLowerCase())!=-1&&(g=!0),g){var i=f.category;if(i){var j=d[f.category];j||(j=c.getCategory(f),d[f.category]=j),b?(console.log(f),j.find("ul").append(c.getCustomSnippetMenuItem(f._id,f.name,f.icon))):j.find("ul").append(c.getMenuItem(f.name,f.icon))}}}),d},LacetEastPanel.prototype.initDoubleClickSnippet=function(){var a=this;jQuery(".dropbang").unbind("dblclick.workit").bind("dblclick.workit",function(){var b=a.getSnippetByName(jQuery(this).attr("klass")),c=b.clone();window.lacetEditor.addSnippet(c,!1)}).unbind("click").bind("click",function(a){a.preventDefault(),a.stopPropagation()})},LacetEastPanel.prototype.initDragSnippet=function(){var a=this;jQuery(".dropbang").draggable({opacity:.5,tolerance:"pointer",connectToSortable:".sortable",cancel:".editctrl,.controls, table, td, th, tr,.locked",helper:function(b){b.stopPropagation();var c=a.getSnippetByName(jQuery(this).attr("klass"));return a.getHelper(c)},stop:function(a,b){return b.helper.fadeOut(),!0}})},LacetEastPanel.prototype.getCategory=function(a){var b=a.category,c=a.icon,d="menu_"+a.snip_id,e=jQuery('<li data-toggle="collapse" data-target="#'+d+'" class="collapsed"></li>'),f=jQuery("<a></a>");return f.append(jQuery("<i></i>").addClass(c)),f.append(jQuery("<span></span>").addClass("nav-label").html(b)),f.append(jQuery("<span></span>").addClass("fa arrow").addClass("pull-right")),e.append(f),e.append(jQuery('<ul class="sub-menu collapse" id="'+d+'"></ul>')),e},LacetEastPanel.prototype.getHelper=function(a){return jQuery("<div></div>").addClass("snippet_drop").append(jQuery("<i></i>").addClass(a.icon).addClass("fa-3x")).append(jQuery("<p></p>").html(a.name)).appendTo("Body").css("zIndex",500).attr("klass",a.klass).attr("id",a.snip_id)},LacetEastPanel.prototype.loadPages=function(){var a=this;window.pages.qry().find(function(b){jQuery("#pages").empty(),jQuery.each(b.rows,function(b,c){jQuery("#pages").append(a.getPageMenuItem(c._id,c.name,"fa fa-file-o fa-lg"))}),jQuery(".removePage").unbind("click").bind("click",function(b){b.stopPropagation();var c=$(this).parent().parent().attr("id");a.removePage(c)}),jQuery(".showPage").unbind("click").bind("click",function(b){b.stopPropagation();var c=$(this).attr("id");a.showPage(c)}),jQuery(".viewPage").unbind("click").bind("click",function(a){a.stopPropagation();var b=$(this).parent().find(".nav-label").html();window.location="/#/lacet/"+b})})},LacetEastPanel.prototype.readJsonFiles=function(){var a=$.Deferred();if(window.File&&window.FileReader&&window.FileList&&window.Blob){var b=jQuery('<input type="file" id="files" name="files[]" multiple />').appendTo("body");b.click(function(){$(this).change(function(b){for(var c,d=b.target.files,e=[],f=0;c=d[f];f++){var g=new FileReader;g.onload=function(b){return function(b){try{e.push(JSON.parse(b.target.result)),f===d.length&&a.resolve(e)}catch(a){console.log(a)}}}(c),g.readAsText(c)}$(this).remove()})})[0].click()}else alert("The File APIs are not fully supported in this browser.");return a.promise()},LacetEastPanel.prototype.initPageEvents=function(){var a=this;$("#newPage").unbind("click").bind("click",function(b){window.lacetEditor.newPage(),a.updatePageName()}),$("#importPage").unbind("click").bind("click",function(b){a.readJsonFiles().done(function(b){console.log("Importing Pages"),console.log(b),jQuery.each(b,function(b,c){window.pages.save(c,function(b){a.loadPages()})})})}),$("#exportPage").unbind("click").bind("click",function(a){var b=JSON.parse(localStorage.snippetData),c="data:application/json,"+encodeURIComponent(JSON.stringify(b));jQuery("<a />",{download:b.name+".json",href:c}).appendTo("body").click(function(){$(this).remove()})[0].click()}),$("#viewCachedPage").unbind("click").bind("click",function(a){a.stopPropagation(),window.location="#/lacetviewer"}),$("#savePage").unbind("click").bind("click",function(b){b.stopPropagation(),a.savePage()}),$("#pageName").unbind("click").bind("click",function(b){b.stopPropagation(),a.editPageName()})},LacetEastPanel.prototype.removePage=function(a){var b=this;window.pages.remove(a,function(){b.loadPages()})},LacetEastPanel.prototype.showPage=function(a){var b=this;window.pages.getById(a,function(a){window.lacetEditor.showPage(a),b.updatePageName()})},LacetEastPanel.prototype.updatePageName=function(){var a=window.lacetEditor.page.name;a||(a="Untitled"),$("#pageName").html(a)},LacetEastPanel.prototype.savePage=function(){var a=this,b=window.lacetEditor.page.saveObject();console.log("Save Page"),console.log(b),window.pages.save(b,function(b){console.log("Save Page Result"),console.log(b),window.lacetEditor.showPage(b),a.updatePageName(),a.loadPages()})},LacetEastPanel.prototype.editPageName=function(){var a=this;bootbox.dialog({title:"Edit Page Name",message:'<div class="row">  <div class="col-md-12"> <form class="form-horizontal"> <div class="form-group"> <label class="col-md-2 control-label" for="propPageName">Name</label> <div class="col-md-8"> <input id="propPageName" name="propPageName" type="text" placeholder="Page Name" class="form-control input-md"> </div></div></form> </div>  </div>',buttons:{success:{label:"Save",className:"btn-default",callback:function(){window.lacetEditor.page.name=$("#propPageName").val(),$("#pageName").html(window.lacetEditor.page.name),a.savePage()}}}}),$("#propPageName").val($("#pageName").html())},LacetEastPanel.prototype.getPageMenuItem=function(a,b,c){var d=jQuery('<li class="showPage"></li>').attr("id",a),e=jQuery("<a></a>");return e.append(jQuery("<i></i>").addClass(c)),e.append(jQuery("<span></span>").addClass("nav-label").html(b)),e.append(jQuery('<i class="menuIcon removePage" ></i>').addClass("fa fa-remove fa-lg pull-right")),e.append(jQuery('<i class="menuIcon viewPage" ></i>').addClass("fa fa-eye fa-lg pull-right")),d.append(e),d},window.lacetEastPanel=new LacetEastPanel,jQuery(function(){}),window.lacetEastPanel}(jQuery),function(){function a(){this.shortCuts=!0}return a.prototype.enableShortCuts=function(){this.shortCuts=!0},a.prototype.disableShortCuts=function(){this.shortCuts=!1},a.prototype.init=function(a){var b=this;$(a).load("lacet/editor/lacet_editor.html",function(a,c,d){"success"==c?window.lacetEastPanel.init().done(function(){b.run()}):"error"==c&&console.log("Error: "+d.status+": "+d.statusText)})},a.prototype.newPage=function(){this.newView(),this.render()},a.prototype.showPage=function(a){this.page=this.page.loadObject(a),this.render()},a.prototype.addSnippet=function(a,b){this.selectedcontrol&&this.selectedcontrol&&this.selectedcontrol.isContainer()?this.selectedcontrol.add(a,b):this.page.add(a,b),this.render()},a.prototype.run=function(){window.lacetEditor.selectedcontrol=null,window.lacetEditor.maincontent=jQuery("#main-content").css("padding","10px").css("outline","1px solid lightgray").css("margin-bottom","10px"),this.loadLocal(),this.render()},a.prototype.render=function(){var a=jQuery(".selected_control");this.renderCSS();this.page.render(window.lacetEditor.maincontent);this.saveLocal(),this.initResizeable(),this.initSelectable(),this.initDragAndDrop(),this.initEditable(),this.initTabs(),this.reSelectControls(a),this.enableShortCuts()},a.prototype.renderCSS=function(){var a=this.page.compileCSS(),b=jQuery("#snippetStyles");0==b.length&&($("head").append(jQuery('<style id="snippetStyles"></style>')),b=jQuery("#snippetStyles")),b.html(""),$.each(a,function(a,c){try{b.append(c)}catch(a){}})},a.prototype.initResizeable=function(){var a=this;jQuery(".resizeable").resizable({aspectRatio:!1,handles:"e",minWidth:20,helper:"ui-resizable-helper",minHeight:20,ghost:!0,autoHide:!0,stop:function(b,c){b.stopImmediatePropagation();var d=a.getById(b.target.id),e=d.private.parent;if(e&&"SnippetRow"===e.type){console.log("resizable event fired on "+b.target.id+"Parent = "+e.snip_id);var f=jQuery("#"+e.snip_id).width()/12,g=Math.round((c.size.width-c.originalSize.width)/f);e.adjustColumns(d.snip_id,g)}return a.render(),!0}})},a.prototype.saveLocal=function(){localStorage.snippetData=this.page.save()},a.prototype.loadLocal=function(){this.newView();var a=localStorage.snippetData;a&&null!=a&&"undefined"!==a&&(this.page=this.page.load(a),window.lacetEastPanel&&window.lacetEastPanel.updatePageName())},a.prototype.newView=function(){var a=this;this.page=new SnippetContainer("Untitled"),jQuery(window.lacetEditor.maincontent).mouseover(function(){a.page.showBorders()}),jQuery(window.lacetEditor.maincontent).mouseout(function(){a.page.hideBorders()}),this.initKeyHandlers()},a.prototype.cut=function(){var a=this.selectedcontrol;a&&(localStorage.clipboard=JSON.stringify(a,a.privateVariables),window.lacetEditor.page.remove(a),this.render())},a.prototype.copy=function(){var a=this.selectedcontrol;a&&(localStorage.clipboard=JSON.stringify(a,a.privateVariables))},a.prototype.paste=function(){if(this.selectedcontrol&&this.selectedcontrol.isContainer()){var a=this.selectedcontrol.loadObject(JSON.parse(localStorage.clipboard));this.selectedcontrol.add(a),this.render()}},a.prototype.initEditable=function(){var a=this;jQuery(":hasClassStartingWith('editable-')").unbind("dblclick").bind("dblclick",function(b){b.stopPropagation(),b.preventDefault(),a.disableSorting(),a.disableShortCuts(),a.editing=!0,jQuery(".editable-text-check").each(function(){jQuery(this).click()});var c=a.findSnippet(jQuery(this));c||(c=a.getById(a.selectedcontrol.snip_id));var d=jQuery(this).clone(),e=a.getTextInfo(jQuery(this)),f=jQuery("<div></div>").attr("id","editor");if(d.hasClass("editable-label"))f=jQuery("<input />").keyup(function(a){13==a.keyCode&&jQuery(this).trigger("enterKey")}).val(d.html()).unbind("enterKey").bind("enterKey",function(){jQuery(this).blur()}).blur(function(){var b=d.attr("index");d.hasClass("buttonlabel")?c.setVal(["buttonlabel"],jQuery(this).val(),b):c.setVal(["label"],jQuery(this).val(),b),a.editing=!1,a.render()}),jQuery(this).replaceWith(f),f.css("width",e.width+50).css("height",e.height+20);else{jQuery(".rich-te-config-box").addClass("show");var g=jQuery("<div></div>");g.append(f.html(e.html).css("height",e.height+30).css("width",e.width)),g.append(jQuery("<a></a>").addClass("btn btn-primary").attr("title","save").append(jQuery("<i></i>").addClass("fa fa-check editable-text-check"))),jQuery(this).replaceWith(g),jQuery("#main-content").mousedown(function(a){a.target.id&&"editor"===a.target.id||jQuery(a.target).parents("#editor").length||jQuery(".editable-text-check").click()}),jQuery(".editable-text-check").unbind("click").bind("click",function(){var b=jQuery("#editor").cleanHtml();d.hasClass("editable-header")?c.setVal(["header"],b):d.hasClass("editable-text")?c.setVal(["text"],b):d.hasClass("editable-linkText")?c.setVal(["linkText"],b):d.hasClass("editable-footer")?c.setVal(["footer"],b):alert("Cannot Find Editable Class"),jQuery(".rich-te-config-box").removeClass("show"),a.editing=!1,a.render()});var h=jQuery("#editor");h.wysiwyg();h.offset()}f.css("background-color","transparent").css("fontSize",e.font_size).css("padding","5px").css("cursor","text").css("border","1px dashed lightgray").css("outline","none"),jQuery(".theme-config-box").removeClass("show")})},a.prototype.initSelectable=function(){var a=this;jQuery(".selectable").unbind("click").bind("click",function(b){if(!a.editing){b.stopPropagation(),b.shiftKey||a.clearSelection(),jQuery(this).toggleClass("selected_control");var c=jQuery(this).attr("id");console.log(c),a.selectedcontrol=a.getById(c),"SnippetTabRow"==a.selectedcontrol.klass&&(jQuery(b.target).tab("show"),a.selectedcontrol.activeTab!=jQuery(b.target).parent().index()&&(a.selectedcontrol.activeTab=jQuery(b.target).parent().index(),a.render()))}}).not(":hasClassStartingWith('editable-')").unbind("dblclick").bind("dblclick",function(b){a.editing||(b.stopPropagation(),window.lacetInspector.showInspector(),jQuery(".theme-config-box").addClass("show"))})},a.prototype.renderSelected=function(){if(window.lacetEditor.selectedcontrol){var a=window.lacetEditor.selectedcontrol.render();jQuery("#"+window.lacetEditor.selectedcontrol.snip_id).html(a.html()),this.initEditable(),this.initSelectable()}},a.prototype.getTextInfo=function(a){var b=a.html(),c=a.height(),d=parseFloat(a.css("line-height")),e=Math.round(c/d);return{html:b,height:c,line_height:d,rows:e,font_size:a.css("fontSize"),width:Number(a.width())}},a.prototype.findSnippet=function(a){return a&&a.attr("id")&&0===a.attr("id").indexOf("snippet_")?this.getById(a.attr("id")):a.parent()?this.findSnippet(a.parent()):null},a.prototype.disableSorting=function(){jQuery(".sortable").sortable("disable").disableSelection("disabled").unbind("click").unbind("mousedown").unbind("mouseup").unbind("selectstart").unbind("dblclick")},a.prototype.clearSelection=function(){var a=this;jQuery.each(jQuery(".selected_control"),function(){jQuery(this).removeClass("selected_control"),a.selectedcontrol=null})},a.prototype.listSelectedControls=function(){var a=this,b=[];return jQuery(".selected_control").each(function(){var c=a.getById(jQuery(this).attr("id"));b.push(c)}),b},a.prototype.deleteSelected=function(){jQuery.each(this.listSelectedControls(),function(a,b){window.lacetEditor.page.remove(b)}),this.render()},a.prototype.reSelectControls=function(a){jQuery.each(a,function(a,b){jQuery("#"+b.snip_id).addClass("selected_control")})},a.prototype.getById=function(a){return window.lacetEditor.page.getById(a)},a.prototype.initTabs=function(){jQuery(".nav-tabs .active").tab("show"),jQuery('[role="iconpicker"]').iconpicker()},a.prototype.initKeyHandlers=function(){var a=this;jQuery(document).unbind("keydown"),jQuery(document).unbind("keyup"),jQuery(document).bind("keydown",function(b){if(a.shortCuts)switch(b.which){case 46:return b.preventDefault(),a.deleteSelected(),!0;case 88:return b.ctrlKey&&a.cut(),!0;case 67:return b.ctrlKey&&a.copy(),!0;case 86:return b.ctrlKey&&a.paste(),!0}})},a.prototype.initDragAndDrop=function(){var a=null,b=this;jQuery(".sortable").sortable({opacity:.5,connectWith:".sortable",forcePlaceholderSize:!0,forceHelperSize:!0,tolerance:"pointer",receive:function(c,d){c.stopImmediatePropagation();var e=b.getById(c.target.id);if(e&&e.isContainer()||(e=b.getById(e.parent)),e&&e.isContainer()&&d.item.hasClass("dropbang")){var f=window.lacetEastPanel.getSnippetByName(d.item.attr("klass")),g=f.clone();a=g.snip_id,e.add(g)}else{var h=b.getById(d.item.attr("id"));if(h&&(e&&e.isContainer()||(e=b.getById(h.parent)),e&&e.isContainer())){var i=b.getById(h.parent);i&&(i.remove(h),e.add(h))}}},update:function(c,d){console.log("update receive event fired for "+c.target.id);var e=b.getById(c.target.id);if(!e||!e.isContainer()){var f=b.getById(d.item.attr("id"));f&&(e=b.getById(f.parent))}if(e&&e.isContainer()){var g=d.item.attr("id"),h=e.snippetIndex(g);if(!h&&a&&(h=e.snippetIndex(a)),null!=h){var i=d.item.index();i<e.snippets.length&&e.move(h,i)}}return b.render(),!0}})},window.lacetEditor=new a,jQuery(function(){}),window.lacetEditor}(jQuery),function(){function a(){this.editor=null}return a.prototype.getPage=function(){return window.lacetEditor.page},a.prototype.buildFormDropList=function(){var a=this.getPage().listForms(),b=[];return $.each(a,function(a,c){console.log(c);try{b.push("<li><a>"+c.properties.endpoint+"</a></li>")}catch(a){console.log(a)}b.sort()}),b},a.prototype.showInspector=function(){var a=this,b=window.lacetEditor;if(!this.editing)if(b.selectedcontrol){b.disableShortCuts();var c=$("<div></div>");c.load("lacet/editor/lacet_inspector.html",function(d,e,f){bootbox.dialog({title:"Edit Snippet Parameters",message:c,size:"large",className:"InspectorDialog",onEscape:function(a){b.enableShortCuts()},buttons:{success:{label:"Save",className:"btn-success",callback:function(){b.saveLocal(),b.render()}}}}),a.renderInspector().done(function(c){c&&b.selectedcontrol.value&&(a.prev&&JSON.stringify(b.selectedcontrol.value)!==JSON.stringify(a.prev),a.prev=c)}),a.renderEditors()})}else jQuery("#inspectorPalette").html("Nothing Selected")},a.prototype.getPrettyData=function(a,b){var c={source:a,mode:"beautify",lang:b,wrap:150,inchar:"\t",insize:1};return prettydiff(c)},a.prototype.renderInspector=function(){var a=this,b=$.Deferred(),c=window.lacetEditor.selectedcontrol;if(c.properties.field_endpoint){var d=c.findEndPoint();console.log(d),d&&(c.properties.field_endpoint=d)}a.editor&&(a.editor.destroy(),a.editor=null);var e=c.schema();return e&&(a.editor=new JSONEditor(document.getElementById("inspectorPalette"),{iconlib:"fontawesome4",schema:e,show_errors:"always",expand_height:!1,disable_collapse:!0,disable_edit_json:!0,disable_properties:!1,disable_array_delete:!1,disable_array_delete_all_rows:!0,disable_array_delete_last_row:!0}),a.editor.setValue(c.properties),a.editor.on("change",function(){c.properties!==a.editor.getValue()&&(c.properties=a.editor.getValue(),c.propertiesChanged()),b.resolve(c.properties)})),b.promise()},a.prototype.renderEditors=function(){var a=window.lacetEditor,b=this.configureEditor("htmlEditor",window.lacetEditor.selectedcontrol.template,"html"),c=window.lacetEditor.selectedcontrol.css;c||(c="/*-- CSS For "+window.lacetEditor.selectedcontrol.name+"---*/");var d=this.configureEditor("cssEditor",c,"css");$("#saveHTMLTemplate").unbind("click").bind("click",function(c){window.lacetEditor.selectedcontrol.setTemplate(b.getValue()),a.saveLocal(),a.renderSelected()}),$("#saveCSS").unbind("click").bind("click",function(b){window.lacetEditor.selectedcontrol.setCss(d.getValue()),a.saveLocal(),a.renderCSS()}),$('[data-toggle="tab"]').unbind("click").bind("click",function(a){b.renderer.updateFull(),d.renderer.updateFull()})},a.prototype.configureEditor=function(a,b,c){var d=ace.edit(a);d.setTheme("ace/theme/idle_fingers"),d.setOptions({});var e=this.getPrettyData(b,c);return d.setValue(e[0],-1),d.getSession().setMode("ace/mode/"+c),d},window.lacetInspector=new a,jQuery(function(){}),window.lacetInspector}(jQuery),function(){function a(){this.editor=null}return a.prototype.showSnippetBuilder=function(a){var b=$.Deferred(),c=this,d=$("<div></div>");return d.load("lacet/editor/snippet_builder.html",function(){bootbox.dialog({title:"Snippet Builder",message:d,size:"large",className:"SnippetEditor",buttons:{success:{label:"Save",className:"btn-success",callback:function(){c.saveCustomSnippet(),b.resolve()}}}}),c.initEditors(a)}),b.promise()},a.prototype.newCustomSnippet=function(){return this.showSnippetBuilder()},a.prototype.removeCustomSnippet=function(a){var b=this;window.custom_snippets.remove(a,function(){b.refresh()})},a.prototype.refresh=function(a){window.lacetEastPanel.loadCustomSnippets(function(){window.lacetEastPanel.initSnippetEvents(),a&&a()})},a.prototype.editCustomSnippet=function(a){return this.showSnippetBuilder(a)},a.prototype.loadCustomSnippets=function(a){var b={};window.custom_snippets.qry().find(function(c){console.log(c),$.each(c.rows,function(a,c){var d=c.category;if(d){var e=b[d];e||(b[d]=[]),e.push(c)}}),a&&a(b)})},a.prototype.serializeSnippet=function(){var a=this,b=$("#snippetForm").serializeObject(),c=b._id;return c&&(b._id=b._id),b.schema=a.schemaEditor.getValue(),b.template=a.htmlEditor.getValue(),a.cssEditor.getValue()&&(b.css=a.cssEditor.getValue()),b},a.prototype.loadCustomSnippets=function(a){var b=this;window.custom_snippets.qry().find(function(c){var d=new SnippetContainer("SnippetList");$.each(c.rows,function(a,c){var e=b.loadSnippetJson(c);e&&d.add(e)}),a&&a(d)})},a.prototype.loadSnippetJson=function(a){try{var b=snippetTypes.createValidSchema(a);snippetTypes.add(b);var c=a.kind,d=a.name,e=new Snippet(d,c);if(e)return e.setKlass("Snippet"),e.setCategory(a.category),e.setIcon("fa "+a.icon),e.setTemplate(a.template),e.setCss(a.css),e._id=a._id,console.log(e),e}catch(a){console.log("Snippet Issue error is ->"+a)}return null},a.prototype.saveCustomSnippet=function(){var a=this,b=a.serializeSnippet();window.custom_snippets.save(b,function(a){console.log(a)})},a.prototype.initEditors=function(a){var b=this;$('[role="iconpicker"]').iconpicker({placement:"left",icon:$('[name="icon"]').val()}).on("change",function(a){$('[name="icon"]').val(a.icon)});var c="{}",d="<div></div>",e='@charset "UTF-8"';a?window.custom_snippets.getById(a,function(a){$('[name="_id"]').val(a._id),$('[name="kind"]').val(a.kind),$('[name="name"]').val(a.name),$('[name="icon"]').val(a.icon),$('[name="category"]').val(a.category),$('[name="tags"]').val(a.tags),a.schema&&(c=a.schema),a.template&&(d=a.template),a.css&&(e=a.css),b.schemaEditor=b.configureEditor("schema",c,"json"),b.htmlEditor=b.configureEditor("template",d,"html"),b.cssEditor=b.configureEditor("css",e,"css")}):(b.schemaEditor=b.configureEditor("schema",c,"json"),b.htmlEditor=b.configureEditor("template",d,"html"),b.cssEditor=b.configureEditor("css",e,"css"))},a.prototype.getPrettyData=function(a,b){var c={source:a,mode:"beautify",lang:b,wrap:150,inchar:"\t",insize:1};return prettydiff(c)},a.prototype.configureEditor=function(a,b,c){var d=ace.edit(a);d.setTheme("ace/theme/idle_fingers"),d.setOptions({maxLines:1/0});var e=this.getPrettyData(b,c);return d.setValue(e[0],-1),d.getSession().setMode("ace/mode/"+c),d},window.snippetBuilder=new a,jQuery(function(){}),window.snippetBuilder}(jQuery),function(){function a(){}return a.prototype.init=function(a,b){var c=this,d=b.page;$(a).load("lacet/viewer/lacet_viewer.html",function(a,e,f){d?c.renderPage(d,b):c.renderLocalStorage()})},a.prototype.findPage=function(a,b){var c=this;$.getJSON("lacet/pages/"+a+".json",function(a){window.pages.save(a,function(a){c.render(a,b)})})},a.prototype.renderPage=function(a,b){var c=this,d=setTimeout(function(){var a=jQuery('<div><p><i class="fa fa-spin fa-spinner"></i> Loading...</p></div>');a.append("<h4>We are experiencing a high volume of traffic.</h4><h5> For the best experience please try again later.</h5>"),bootbox.alert(a.html())},2e3);window.pages.qry().eq("name",a).find().done(function(d){var e=d.rows[0];e||c.findPage(a,b),"Home"===a?c.render(e,b):b.account_service.get(function(a){window.session.init({account:a}),window.session.isAuthenticated()?c.render(e,b):window.location="#/login"})}).fail(function(d){c.findPage(a,b)}).complete(function(){clearTimeout(d)})},a.prototype.renderLocalStorage=function(){this.render(JSON.parse(localStorage.snippetData))},a.prototype.render=function(a,b){var c=null;if(a&&(c=(new SnippetContainer).loadObject(a),c.setEditMode(!1),c.addSessionVars(b),c.render("#view-content").css("margin-bottom","50px").find('[role="iconpicker"]').iconpicker()),c){var d=c.compileCSS(),e=jQuery("#snippetStyles");0==e.length&&($("head").append(jQuery('<style id="snippetStyles"></style>')),e=jQuery("#snippetStyles")),e.html(""),$.each(d,function(a,b){try{e.append(b)}catch(a){}})}},window.lacetViewer=new a,jQuery(function(){}),window.lacetViewer}(jQuery);